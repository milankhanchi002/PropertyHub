{"ast":null,"code":"import _objectSpread from\"/Users/milankhanchi/PropertyHubFinal/PropertyHub/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState}from\"react\";import{uploadPropertyImages}from\"../api\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function PropertyForm(){const storedUser=localStorage.getItem(\"user\");const user=storedUser?JSON.parse(storedUser):null;const token=localStorage.getItem(\"token\");const[form,setForm]=useState({title:\"\",description:\"\",address:\"\",city:\"\",type:\"HOUSE\",price:\"\",available:true});const[loading,setLoading]=useState(false);const[statusMessage,setStatusMessage]=useState(\"\");const[files,setFiles]=useState([]);function change(e){const{name,value,type,checked}=e.target;setForm(_objectSpread(_objectSpread({},form),{},{[name]:type===\"checkbox\"?checked:value}));}async function submit(e){e.preventDefault();if(!user||!token){setStatusMessage(\"You must be logged in as OWNER or ADMIN to post a property.\");return;}setLoading(true);setStatusMessage(\"Posting property...\");try{const payload=_objectSpread(_objectSpread({},form),{},{price:Number(form.price)});const res=await fetch(\"http://localhost:8080/api/properties?ownerId=\".concat(user.id),{method:\"POST\",headers:{\"Content-Type\":\"application/json\",\"Authorization\":\"Bearer \".concat(token)},body:JSON.stringify(payload)});if(!res.ok){const errorText=await res.text();throw new Error(\"Status \".concat(res.status,\": \").concat(errorText));}const data=await res.json();// If images were selected, upload them now\nif(files&&files.length>0){try{setStatusMessage(\"Uploading images...\");const uploaded=await uploadPropertyImages(data.id,files);setStatusMessage(\"Property \\\"\".concat(data.title,\"\\\" posted with \").concat(uploaded.length,\" image(s)!\"));}catch(imgErr){console.error(imgErr);setStatusMessage(\"Property \\\"\".concat(data.title,\"\\\" posted, but image upload failed: \").concat(imgErr.message));}}else{setStatusMessage(\"Property \\\"\".concat(data.title,\"\\\" posted successfully!\"));}setForm({title:\"\",description:\"\",address:\"\",city:\"\",type:\"HOUSE\",price:\"\",available:true});setFiles([]);}catch(err){console.error(err);setStatusMessage(\"Failed to post property: \"+err.message);}finally{setLoading(false);}}return/*#__PURE__*/_jsxs(\"div\",{style:{maxWidth:\"500px\",margin:\"auto\"},children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Post a Property\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:submit,children:[/*#__PURE__*/_jsx(\"input\",{name:\"title\",placeholder:\"Title\",value:form.title,onChange:change,required:true}),/*#__PURE__*/_jsx(\"input\",{name:\"description\",placeholder:\"Description\",value:form.description,onChange:change,required:true}),/*#__PURE__*/_jsx(\"input\",{name:\"address\",placeholder:\"Address\",value:form.address,onChange:change,required:true}),/*#__PURE__*/_jsx(\"input\",{name:\"city\",placeholder:\"City\",value:form.city,onChange:change,required:true}),/*#__PURE__*/_jsxs(\"select\",{name:\"type\",value:form.type,onChange:change,children:[/*#__PURE__*/_jsx(\"option\",{value:\"HOUSE\",children:\"House\"}),/*#__PURE__*/_jsx(\"option\",{value:\"APARTMENT\",children:\"Apartment\"}),/*#__PURE__*/_jsx(\"option\",{value:\"VILLA\",children:\"Villa\"}),/*#__PURE__*/_jsx(\"option\",{value:\"RENT\",children:\"Rent\"}),/*#__PURE__*/_jsx(\"option\",{value:\"SALE\",children:\"Sale\"})]}),/*#__PURE__*/_jsx(\"input\",{name:\"price\",type:\"number\",placeholder:\"Price\",value:form.price,onChange:change,required:true}),/*#__PURE__*/_jsxs(\"label\",{children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",name:\"available\",checked:form.available,onChange:change}),\" Available\"]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:\"0.75rem\"},children:[/*#__PURE__*/_jsx(\"label\",{style:{display:\"block\",marginBottom:\"0.25rem\"},children:\"Property Images\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",multiple:true,accept:\"image/*\",onChange:e=>setFiles(Array.from(e.target.files||[]))}),files&&files.length>0&&/*#__PURE__*/_jsxs(\"p\",{style:{fontSize:\"0.875rem\",color:\"#4a5568\"},children:[files.length,\" file(s) selected\"]})]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:loading,children:loading?\"Posting...\":\"Post Property\"})]}),statusMessage&&/*#__PURE__*/_jsx(\"p\",{children:statusMessage})]});}","map":{"version":3,"names":["React","useState","uploadPropertyImages","jsx","_jsx","jsxs","_jsxs","PropertyForm","storedUser","localStorage","getItem","user","JSON","parse","token","form","setForm","title","description","address","city","type","price","available","loading","setLoading","statusMessage","setStatusMessage","files","setFiles","change","e","name","value","checked","target","_objectSpread","submit","preventDefault","payload","Number","res","fetch","concat","id","method","headers","body","stringify","ok","errorText","text","Error","status","data","json","length","uploaded","imgErr","console","error","message","err","style","maxWidth","margin","children","onSubmit","placeholder","onChange","required","marginTop","display","marginBottom","multiple","accept","Array","from","fontSize","color","disabled"],"sources":["/Users/milankhanchi/PropertyHubFinal/PropertyHub/frontend/src/components/PropertyForm.js"],"sourcesContent":["import React, { useState } from \"react\";\r\nimport { uploadPropertyImages } from \"../api\";\r\n\r\nexport default function PropertyForm() {\r\n  const storedUser = localStorage.getItem(\"user\");\r\n  const user = storedUser ? JSON.parse(storedUser) : null;\r\n  const token = localStorage.getItem(\"token\");\r\n\r\n  const [form, setForm] = useState({\r\n    title: \"\",\r\n    description: \"\",\r\n    address: \"\",\r\n    city: \"\",\r\n    type: \"HOUSE\",\r\n    price: \"\",\r\n    available: true,\r\n  });\r\n\r\n  const [loading, setLoading] = useState(false);\r\n  const [statusMessage, setStatusMessage] = useState(\"\");\r\n  const [files, setFiles] = useState([]);\r\n\r\n  function change(e) {\r\n    const { name, value, type, checked } = e.target;\r\n    setForm({\r\n      ...form,\r\n      [name]: type === \"checkbox\" ? checked : value,\r\n    });\r\n  }\r\n\r\n  async function submit(e) {\r\n    e.preventDefault();\r\n\r\n    if (!user || !token) {\r\n      setStatusMessage(\"You must be logged in as OWNER or ADMIN to post a property.\");\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n    setStatusMessage(\"Posting property...\");\r\n\r\n    try {\r\n      const payload = { ...form, price: Number(form.price) };\r\n\r\n      const res = await fetch(\r\n        `http://localhost:8080/api/properties?ownerId=${user.id}`,\r\n        {\r\n          method: \"POST\",\r\n          headers: {\r\n            \"Content-Type\": \"application/json\",\r\n            \"Authorization\": `Bearer ${token}`,\r\n          },\r\n          body: JSON.stringify(payload),\r\n        }\r\n      );\r\n\r\n      if (!res.ok) {\r\n        const errorText = await res.text();\r\n        throw new Error(`Status ${res.status}: ${errorText}`);\r\n      }\r\n\r\n      const data = await res.json();\r\n\r\n      // If images were selected, upload them now\r\n      if (files && files.length > 0) {\r\n        try {\r\n          setStatusMessage(\"Uploading images...\");\r\n          const uploaded = await uploadPropertyImages(data.id, files);\r\n          setStatusMessage(`Property \"${data.title}\" posted with ${uploaded.length} image(s)!`);\r\n        } catch (imgErr) {\r\n          console.error(imgErr);\r\n          setStatusMessage(`Property \"${data.title}\" posted, but image upload failed: ${imgErr.message}`);\r\n        }\r\n      } else {\r\n        setStatusMessage(`Property \"${data.title}\" posted successfully!`);\r\n      }\r\n\r\n      setForm({\r\n        title: \"\",\r\n        description: \"\",\r\n        address: \"\",\r\n        city: \"\",\r\n        type: \"HOUSE\",\r\n        price: \"\",\r\n        available: true,\r\n      });\r\n      setFiles([]);\r\n    } catch (err) {\r\n      console.error(err);\r\n      setStatusMessage(\"Failed to post property: \" + err.message);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div style={{ maxWidth: \"500px\", margin: \"auto\" }}>\r\n      <h2>Post a Property</h2>\r\n      <form onSubmit={submit}>\r\n        <input name=\"title\" placeholder=\"Title\" value={form.title} onChange={change} required />\r\n        <input name=\"description\" placeholder=\"Description\" value={form.description} onChange={change} required />\r\n        <input name=\"address\" placeholder=\"Address\" value={form.address} onChange={change} required />\r\n        <input name=\"city\" placeholder=\"City\" value={form.city} onChange={change} required />\r\n        <select name=\"type\" value={form.type} onChange={change}>\r\n          <option value=\"HOUSE\">House</option>\r\n          <option value=\"APARTMENT\">Apartment</option>\r\n          <option value=\"VILLA\">Villa</option>\r\n          <option value=\"RENT\">Rent</option>\r\n          <option value=\"SALE\">Sale</option>\r\n        </select>\r\n        <input name=\"price\" type=\"number\" placeholder=\"Price\" value={form.price} onChange={change} required />\r\n        <label>\r\n          <input type=\"checkbox\" name=\"available\" checked={form.available} onChange={change} /> Available\r\n        </label>\r\n        <div style={{ marginTop: \"0.75rem\" }}>\r\n          <label style={{ display: \"block\", marginBottom: \"0.25rem\" }}>Property Images</label>\r\n          <input\r\n            type=\"file\"\r\n            multiple\r\n            accept=\"image/*\"\r\n            onChange={(e) => setFiles(Array.from(e.target.files || []))}\r\n          />\r\n          {files && files.length > 0 && (\r\n            <p style={{ fontSize: \"0.875rem\", color: \"#4a5568\" }}>{files.length} file(s) selected</p>\r\n          )}\r\n        </div>\r\n        <br />\r\n        <button type=\"submit\" disabled={loading}>{loading ? \"Posting...\" : \"Post Property\"}</button>\r\n      </form>\r\n      {statusMessage && <p>{statusMessage}</p>}\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}